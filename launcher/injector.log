01:29:45.4260889 [INFO] [create_process] Creating target process in suspended state
01:29:45.4262261 [INFO] [create_process] Process path: C:\Users\User\Documents\rust\binaries\dll_injector\injector\bin\target.exe
01:29:45.4312045 [INFO] [create_process] Successfully created target process in suspended state
01:29:45.4312505 [INFO] [create_process] Handle to target process: 0x108
01:29:45.4312939 [INFO] [create_process] Handle to target thread: 0x104
01:29:45.4313299 [INFO] [create_process] Target process ID: 3768
01:29:45.4313671 [INFO] [create_process] Target process main thread ID: 1224
01:29:45.431401 [INFO] [allocate_memory] Converting C:\Users\User\Documents\rust\binaries\dll_injector\injector\bin\dll32.dll to CString
01:29:45.4314431 [INFO] [allocate_memory] Converted DLL path: "C:\\Users\\User\\Documents\\rust\\binaries\\dll_injector\\injector\\bin\\dll32.dll"
01:29:45.4316632 [INFO] [allocate_memory] Allocating memory in target process
01:29:45.4316962 [INFO] [allocate_memory] Target process handle: 0x108
01:29:45.4317475 [INFO] [allocate_memory] Successfully allocated memory into target process
01:29:45.4317849 [INFO] [allocate_memory] Base address of allocated memory: 0xc0000
01:29:45.4318207 [INFO] [allocate_memory] Size of allocated memory: 74 bytes
01:29:45.4318579 [INFO] [main] Checking if the pointer to the allocated memory is null
01:29:45.4318905 [INFO] [main] The pointer to DLL path is not null after allocation
01:29:45.4319268 [INFO] [write_memory] Converting C:\Users\User\Documents\rust\binaries\dll_injector\injector\bin\dll32.dll to CString
01:29:45.4319938 [INFO] [write_memory] Converted DLL path: "C:\\Users\\User\\Documents\\rust\\binaries\\dll_injector\\injector\\bin\\dll32.dll"
01:29:45.4322329 [INFO] [write_memory] Writing DLL path to allocated memory
01:29:45.4322665 [INFO] [write_memory] Handle to target process: 0x108
01:29:45.4323028 [INFO] [write_memory] Base address of allocated memory: 0xc0000
01:29:45.432349 [INFO] [write_memory] Successfully wrote "C:\\Users\\User\\Documents\\rust\\binaries\\dll_injector\\injector\\bin\\dll32.dll" to allocated memory!
01:29:45.4325938 [INFO] [write_memory] Bytes written: 74
01:29:45.4326456 [INFO] [write_memory] Successfully changed memory protection back to read-only
01:29:45.4326961 [INFO] [get_loadlib_offset] Converting 'kernel32.dll' name to CString
01:29:45.43273 [INFO] [get_loadlib_offset] Converted target module name: "kernel32.dll"
01:29:45.4327916 [INFO] [get_loadlib_offset] Converting 'LoadLibraryA' function name to CString
01:29:45.4328233 [INFO] [get_loadlib_offset] Converted target function name: "LoadLibraryA"
01:29:45.4328861 [INFO] [get_loadlib_offset] Retrieving handle to "kernel32.dll" module
01:29:45.4329518 [INFO] [get_loadlib_offset] Successfully retrieved handle to "kernel32.dll" module
01:29:45.4330154 [INFO] [get_loadlib_offset] "kernel32.dll" module handle: 0x76490000
01:29:45.4330833 [INFO] [get_loadlib_offset] Retrieving address of "LoadLibraryA" function
01:29:45.4331501 [INFO] [get_loadlib_offset] Successfully retrieved address of "LoadLibraryA" function
01:29:45.4332407 [INFO] [get_loadlib_offset] "LoadLibraryA" function address: 0x764b1270
01:29:45.4333076 [INFO] [get_loadlib_offset] Calculated offset of "LoadLibraryA" function in "kernel32.dll" module: 0x21270
01:29:45.4334849 [INFO] [target_load_static_modules] Allowing target process to load static libraries
01:29:45.4335179 [INFO] [target_load_static_modules] Target process handle: 0x108
01:29:45.4335545 [INFO] [target_load_static_modules] Unsuspending target process
01:29:45.433588 [INFO] [target_load_static_modules] Target process successfully unsuspended
01:29:45.4336216 [INFO] [target_load_static_modules] Target process sleeping for 100 microseconds
01:29:45.4481497 [INFO] [target_load_static_modules] Suspending target process
01:29:45.448217 [INFO] [target_load_static_modules] Checking number of modules loaded by target process
01:29:45.4482505 [INFO] [check_number_of_modules] Calculating number of modules loaded by target process
01:29:45.4483592 [INFO] [check_number_of_modules] Successfully calculated number of modules loaded by target process
01:29:45.44845 [INFO] [check_number_of_modules] Number of modules loaded by target process: 28
01:29:45.4484892 [INFO] [target_load_static_modules] Unsuspending target process
01:29:45.4485236 [INFO] [target_load_static_modules] Target process successfully unsuspended
01:29:45.4485571 [INFO] [target_load_static_modules] Target process sleeping for 100 microseconds
01:29:45.4637035 [INFO] [target_load_static_modules] Suspending target process
01:29:45.4637744 [INFO] [target_load_static_modules] Checking number of modules loaded by target process
01:29:45.463807 [INFO] [check_number_of_modules] Calculating number of modules loaded by target process
01:29:45.4639031 [INFO] [check_number_of_modules] Successfully calculated number of modules loaded by target process
01:29:45.463938 [INFO] [check_number_of_modules] Number of modules loaded by target process: 29
01:29:45.4639727 [INFO] [target_load_static_modules] Unsuspending target process
01:29:45.4640231 [INFO] [target_load_static_modules] Target process successfully unsuspended
01:29:45.4640568 [INFO] [target_load_static_modules] Target process sleeping for 100 microseconds
01:29:45.4793051 [INFO] [target_load_static_modules] Suspending target process
01:29:45.4795849 [INFO] [target_load_static_modules] Checking number of modules loaded by target process
01:29:45.4799839 [INFO] [check_number_of_modules] Calculating number of modules loaded by target process
01:29:45.4807087 [INFO] [check_number_of_modules] Successfully calculated number of modules loaded by target process
01:29:45.4807466 [INFO] [check_number_of_modules] Number of modules loaded by target process: 41
01:29:45.4807848 [INFO] [target_load_static_modules] All static libraries loaded by the target process
01:29:45.4808174 [INFO] [get_module_base_address] Getting module base address for: kernel32.dll
01:29:45.4808516 [INFO] [get_module_base_address] Process handle: 0x108
01:29:45.4811203 [INFO] [get_module_base_address] kernel32.dll base address: 0x76490000 found
01:29:45.4813205 [INFO] [get_loadlib_addr] Calculating address of LoadLibraryA function in target process
01:29:45.481374 [INFO] [get_loadlib_addr] Address of LoadLibraryA function in target process: 0x764b1270
01:29:45.4814131 [INFO] [create_event] Creating Event object
01:29:45.4815133 [INFO] [create_event] Event object created successfully
01:29:45.4816559 [INFO] [create_event] Event handle: 0x110
01:29:45.4817118 [INFO] [create_file_mapping] Converting file mapping name to CString
01:29:45.4817441 [INFO] [create_file_mapping] Successfully converted file mapping name: "Local\\__AA__AA__" to CString
01:29:45.4818893 [INFO] [create_file_mapping] Duplicating event handle
01:29:45.4819236 [INFO] [create_file_mapping] Source process handle: 0xffffffff
01:29:45.4819593 [INFO] [create_file_mapping] Event handle: 0x110
01:29:45.4820168 [INFO] [create_file_mapping] Target process handle: 0x108
01:29:45.4820736 [INFO] [create_file_mapping] Successfully duplicated event handle: 0x110
01:29:45.4821128 [INFO] [create_file_mapping] Duplicated event handle: 0x2e8
01:29:45.4821496 [INFO] [create_file_mapping] Creating file mapping object
01:29:45.4822158 [INFO] [create_file_mapping] Successfully created file mapping object
01:29:45.4822561 [INFO] [create_file_mapping] File mapping handle: 0x10c
01:29:45.4822922 [INFO] [create_file_mapping] Creating view of file mapping in current process
01:29:45.4823315 [INFO] [create_file_mapping] Successfully created view of file mapping in current process
01:29:45.4823639 [INFO] [create_file_mapping] File view pointer: 0x1d0000
01:29:45.4824001 [INFO] [create_file_mapping] Writing duplicated event handle into file mapping
01:29:45.482432 [INFO] [create_file_mapping] Before writing, file view pointer: 0x0
01:29:45.482476 [INFO] [create_file_mapping] Successfully wrote duplicated event handle into file mapping
01:29:45.4825084 [INFO] [create_file_mapping] After writing, file view pointer: 0x2e8
01:29:45.4825449 [INFO] [create_file_mapping] Unmapping view of file mapping in current process
01:29:45.4826011 [INFO] [create_file_mapping] Successfully unmapped view of file mapping in current process
01:29:45.4826352 [INFO] [main] Reading back the written DLL path from allocated memory for validation
01:29:45.4826702 [INFO] [read_memory] Calling ReadProcessMemory
01:29:45.4827169 [INFO] [read_memory] Handle to target process: 0x108
01:29:45.4827595 [INFO] [read_memory] Address to read from: 0xc0000
01:29:45.4827982 [INFO] [read_memory] Size of buffer: 73 bytes
01:29:45.4828452 [INFO] [read_memory] Successfully read memory
01:29:45.4828813 [INFO] [read_memory] Converting read back data to string
01:29:45.4829212 [INFO] [read_memory] Successfully converted read back data to string
01:29:45.4829531 [INFO] [read_memory] Contents of read back data: C:\Users\User\Documents\rust\binaries\dll_injector\injector\bin\dll32.dll
01:29:45.4829883 [INFO] [main] Successfully read back the DLL path from allocated memory
01:29:45.4830201 [INFO] [main] Confirming that the read back data matches the original DLL path
01:29:45.4830605 [INFO] [main] The written DLL path C:\Users\User\Documents\rust\binaries\dll_injector\injector\bin\dll32.dll matches with the original DLL path
01:29:45.483097 [INFO] [main] Waiting for user input to continue program
01:29:55.2979016 [INFO] [create_remote_thread] Creating remote thread in target process
01:29:55.2980325 [INFO] [create_remote_thread] Target process handle: 0x108
01:29:55.2980774 [INFO] [create_remote_thread] Pointer to LoadLibraryA: 0x764b1270
01:29:55.298113 [INFO] [create_remote_thread] Pointer to DLL path: 0xc0000
01:29:55.2982161 [INFO] [create_remote_thread] Remote thread create successfully
01:29:55.2982522 [INFO] [create_remote_thread] Handle to remote thread: 0x12c
01:29:55.2982931 [INFO] [wait_for_event] Waiting for DLL to signal event
01:29:55.2983247 [INFO] [wait_for_event] Event Handle: 0x110
01:29:55.2983604 [INFO] [wait_for_event] Timeout: 1000ms
01:29:55.2983963 [INFO] [wait_for_event] Max Attempts: 5
01:29:55.3035963 [INFO] [wait_for_event] DLL signaled event - Attempt: 0
01:29:55.3036683 [INFO] [main] DLL successfully set event
01:29:55.303721 [INFO] [main] Resuming Target Process Main Thread
01:29:55.3037844 [INFO] [main] Successfully resumed main thread of target process
01:29:55.3038543 [INFO] [cleanup] Resuming target process
01:29:55.3039027 [INFO] [cleanup] Target process handle: 0x108
01:29:55.3039546 [INFO] [cleanup] Target process main thread handle: 0x104
01:29:55.3040058 [INFO] [cleanup] Target process ID: 3768
01:29:55.3040547 [INFO] [cleanup] Target process main thread ID: 1224
01:29:55.3041116 [INFO] [cleanup] Successfully resumed main thread of target process
01:29:55.3041605 [INFO] [cleanup] Freeing allocated memory at address: 0xc0000
01:29:55.3043282 [INFO] [cleanup] Allocated memory at address: 0xc0000 freed successfully
01:29:55.3044085 [INFO] [cleanup] Closing handle to thread: 0x12c
01:29:55.3044754 [INFO] [cleanup] Waiting for thread: 0x12c to finish execution
01:29:55.3045695 [INFO] [cleanup] Thread with handle: 0x12c has finished execution
01:29:55.3050335 [INFO] [cleanup] Handle to thread: 0x12c closed successfully
01:29:55.3050946 [INFO] [cleanup] Closing event handle: 0x110
01:29:55.3051496 [INFO] [cleanup] Checking if event: 0x110 is signaled before closing
01:29:55.3052063 [WARN] [cleanup] Event: 0x110 is not signaled yet
01:29:55.3052612 [INFO] [cleanup] Event handle: 0x110 closed successfully
01:29:55.3053183 [INFO] [cleanup] Closing file mapping object handle: 0x10c
01:29:55.3053802 [INFO] [cleanup] File mapping object handle: 0x10c closed successfully
01:29:55.3055796 [INFO] [cleanup] Closing current process handle: 0xffffffff
01:29:55.3056163 [WARN] [cleanup] Current process handle: 0xffffffff is invalid
01:29:55.3056568 [INFO] [cleanup] Closing target process handle: 0x108
01:29:55.3057057 [INFO] [cleanup] Target process handle: 0x108 closed successfully
01:29:55.3057544 [INFO] [cleanup] Closing target process main thread handle: 0x104
01:29:55.3057918 [INFO] [cleanup] Target process main thread handle: 0x104 closed successfully
