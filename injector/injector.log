02:48:39.3673344 [INFO] [get_running_procs] Enumerating processes
02:48:39.3690012 [INFO] [get_running_procs] Bytes returned: 548 bytes
02:48:39.3690554 [INFO] [get_running_procs] Number of processes enumerated: 137
02:48:39.3690928 [INFO] [get_running_procs] Iterating through process ID and retrieving module base name
02:48:39.3745384 [INFO] [get_running_procs] Processes opened: 56
02:48:39.3745892 [INFO] [get_running_procs] Processes not opened: 80
02:48:39.3746279 [INFO] [get_running_procs] Last error: Access is denied.
02:48:39.3747113 [INFO] [is_target_running] Checking if target process (notepad) is running
02:48:39.3747857 [INFO] [is_target_running] Target process is running: notepad.exe (968)
02:48:39.3748306 [INFO] [get_target_proc_handle] Getting handle to target process (968)
02:48:39.3748759 [INFO] [get_target_proc_handle] Successfully opened target process (968) with handle 0xb0
02:48:39.3749233 [INFO] [main] Target process is 64-bit
02:48:39.3749585 [INFO] [main] Using 64-bit DLL
02:48:39.3752386 [INFO] [allocate_memory] Allocating memory in target process with handle 0xb0
02:48:39.3754048 [INFO] [allocate_memory] Successfully allocated memory into target process with handle 0xb0
02:48:39.375455 [INFO] [allocate_memory] Base address of allocated memory: 0x1af53e10000
02:48:39.3754947 [INFO] [allocate_memory] Size of allocated memory: 74 bytes
02:48:39.3755395 [INFO] [write_memory] Writing "C:\\Users\\User\\Documents\\rust\\binaries\\dll_injector\\injector\\bin\\dll64.dll" to allocated memory at base address 0x1af53e10000
02:48:39.3757673 [INFO] [write_memory] Bytes written: 74
02:48:39.3758121 [INFO] [main] Reading back the written DLL path from allocated memory for validation
02:48:39.3759463 [INFO] [read_memory] Contents of read back data: C:\Users\User\Documents\rust\binaries\dll_injector\injector\bin\dll64.dll
02:48:39.375992 [INFO] [main] The written DLL path C:\Users\User\Documents\rust\binaries\dll_injector\injector\bin\dll64.dll matches with the original DLL path
02:48:39.3760358 [INFO] [get_module_base_address] Getting kernel32.dll base address in target process
02:48:39.3761961 [INFO] [get_module_base_address] kernel32.dll base address: 0x7ff8d35d0000 in target process
02:48:39.3762498 [INFO] [get_function_offset] Retrieving handle to "kernel32.dll" module loaded in current process
02:48:39.3763223 [INFO] [get_function_offset] "kernel32.dll" module handle: 0x7ff8d35d0000 in current_process
02:48:39.3763953 [INFO] [get_function_offset] Retrieving address of "LoadLibraryA" function in current process
02:48:39.376467 [INFO] [get_function_offset] "LoadLibraryA" function address: 0x7ff8d35f0c70 in current process
02:48:39.3765395 [INFO] [get_function_offset] Calculated offset of "LoadLibraryA" function in "kernel32.dll" module: 0x20C70
02:48:39.3766579 [INFO] [get_function_addr] Calculating address of "LoadLibraryA" in target process
02:48:39.3767272 [INFO] [get_function_addr] Address of "LoadLibraryA" in target process: 0x7ff8d35f0c70
02:48:39.3768193 [INFO] [create_remote_thread] Creating remote thread in target process (0xb0)
02:48:39.376927 [INFO] [create_remote_thread] Handle to remote thread: 0xb4
02:48:39.3769734 [INFO] [main] Waiting for remote thread to finish execution of LoadLibraryA
02:48:39.3786884 [INFO] [main] Remote thread finished execution of LoadLibraryA
02:48:39.3787365 [INFO] [get_module_base_address] Getting dll64.dll base address in target process
02:48:39.3795491 [INFO] [get_module_base_address] dll64.dll base address: 0x7ff8cd0b0000 in target process
02:48:39.3796007 [INFO] [main] Validating handle to DLL that was loaded
02:48:39.3796376 [INFO] [main] Valid DLL handle
03:24:52.704895 [INFO] [get_function_offset] Retrieving handle to "kernel32.dll" module loaded in current process
03:24:52.7050629 [INFO] [get_function_offset] "kernel32.dll" module handle: 0x7ff8d35d0000 in current_process
03:24:52.7051342 [INFO] [get_function_offset] Retrieving address of "FreeLibrary" function in current process
03:24:52.7052019 [INFO] [get_function_offset] "FreeLibrary" function address: 0x7ff8d35ecf50 in current process
03:24:52.7053124 [INFO] [get_function_offset] Calculated offset of "FreeLibrary" function in "kernel32.dll" module: 0x1CF50
03:24:52.7054077 [INFO] [get_function_addr] Calculating address of "FreeLibrary" in target process
03:24:52.705481 [INFO] [get_function_addr] Address of "FreeLibrary" in target process: 0x7ff8d35ecf50
03:24:52.7055501 [INFO] [main] Creating remote thread to call FreeLibrary and unload injected DLL
03:24:52.7055882 [INFO] [create_remote_thread] Creating remote thread in target process (0xb0)
03:24:52.7056725 [INFO] [create_remote_thread] Handle to remote thread: 0xb8
03:24:52.7057165 [INFO] [main] Waiting for remote thread to finish execution of FreeLibrary
03:25:00.0299581 [INFO] [main] Remote thread finished execution of FreeLibrary
03:25:00.030025 [ERROR] [main] FreeLibrary failed
03:25:00.0300692 [INFO] [get_module_base_address] Getting dll64.dll base address in target process
03:25:00.0301447 [ERROR] [get_module_base_address] Failed to get module count
03:25:00.0302077 [ERROR] [get_module_base_address] Windows error: Only part of a ReadProcessMemory or WriteProcessMemory request was completed.
03:25:00.0302553 [ERROR] [main] Failed to get base address of dll64.dll: 299
03:25:00.0303071 [ERROR] [main] Windows error: Only part of a ReadProcessMemory or WriteProcessMemory request was completed.
03:25:00.0303531 [ERROR] [cleanup] Failed to free allocated memory at address: 0x1af53e10000
03:25:00.0304031 [ERROR] [cleanup] Windows error: Access is denied.
03:25:00.0304446 [INFO] [cleanup] Closing handle to thread: 0xb4
03:25:00.0304868 [INFO] [cleanup] Waiting for thread: 0xb4 to finish execution
03:25:00.0305331 [INFO] [cleanup] Thread with handle: 0xb4 has finished execution
03:25:00.0305821 [INFO] [cleanup] Handle to thread: 0xb4 closed successfully
03:25:00.0306338 [INFO] [cleanup] Target process handle: 0xb0 closed successfully
